apiVersion: v1
kind: ConfigMap
metadata:
  name: jaco-config
  namespace: jaco-stg
data:
  ENV: "prod"
  DEPLOY_ENV: "staging"
  PORT: "8080"
  DOCKER: "true"
  WEBUI_NAME: "Jaco (QA)"

  # Morpheus API (OpenAI-compatible)
  OPENAI_API_BASE_URL: "https://api.mor.org/api/v1"

  # Disable Ollama (using external LLM APIs only)
  ENABLE_OLLAMA_API: "false"

  # Redis (in-cluster service)
  REDIS_URL: "redis://redis:6379"
  WEBSOCKET_MANAGER: "redis"
  ENABLE_WEBSOCKET_SUPPORT: "true"

  # Domain
  WEBUI_URL: "https://jaco-stg.manifest.network"
  CORS_ALLOW_ORIGIN: "https://jaco-stg.manifest.network"

  # Auth
  ENABLE_SIGNUP: "true"
  ENABLE_DIRECT_CONNECTIONS: "true"
  WEBUI_AUTH: "true"

  # Models — all users can see all models
  BYPASS_MODEL_ACCESS_CONTROL: "true"
  WEBUI_SESSION_COOKIE_SECURE: "true"
  WEBUI_SESSION_COOKIE_SAME_SITE: "lax"

  # Database (smaller pool per worker — PgBouncer handles multiplexing)
  ENABLE_DB_MIGRATIONS: "true"
  DATABASE_POOL_SIZE: "3"
  DATABASE_POOL_MAX_OVERFLOW: "2"
  DATABASE_POOL_RECYCLE: "1800"

  # Server
  UVICORN_WORKERS: "4"
  GLOBAL_LOG_LEVEL: "DEBUG"

  # Content Security Policy
  CONTENT_SECURITY_POLICY: "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: blob:; connect-src 'self' https://api.mor.org wss://jaco-stg.manifest.network; worker-src 'self' blob:; manifest-src 'self'; frame-ancestors 'none'; form-action 'self'; base-uri 'self'; object-src 'none'"

  # Telemetry off
  ANONYMIZED_TELEMETRY: "false"
  SCARF_NO_ANALYTICS: "true"
  DO_NOT_TRACK: "true"
